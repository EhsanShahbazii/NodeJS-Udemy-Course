1
00:00:02,300 --> 00:00:06,300
زمان آن است که دوباره روی مدل محصول خود کار کنیم. در آنجا ما یک روش ذخیره را دریافت می کنیم

2
00:00:06,320 --> 00:00:08,880
و در حال حاضر ما از آن برای ایجاد یک محصول جدید استفاده کردیم.

3
00:00:09,320 --> 00:00:15,080
حال چرا از آن برای به‌روزرسانی یک محصول موجود استفاده نمی‌کنیم، اگر قبلاً آن را داریم؟

4
00:00:16,700 --> 00:00:23,920
برای انجام این کار، کاری که ما باید انجام دهیم این است که در save فقط باید بررسی کنیم که آیا قبلاً یک شناسه داریم و بنابراین

5
00:00:23,920 --> 00:00:31,270
هنگام ایجاد یک محصول جدید، باید یک شناسه را نیز بپذیریم و سپس این شناسه را برابر با ID قرار دهیم اما این کار را خواهیم کرد

6
00:00:31,270 --> 00:00:37,090
به سادگی برای یک محصول کاملاً جدید اینجا را تهی کنید، به طوری که ما همچنان می توانیم محصولاتی ایجاد کنیم که ندارند

7
00:00:37,090 --> 00:00:39,780
شناسه اما پس از آن شناسه در اینجا اختصاص داده می شود

8
00:00:40,000 --> 00:00:47,050
اما اگر من در حال ویرایش یکی از آنها هستیم، شناسه را از قبل داریم، بنابراین می توانیم به سادگی آن را در اینجا اختصاص دهیم. و سپس در ذخیره،

9
00:00:47,080 --> 00:00:53,410
ما به سادگی می‌توانیم بررسی کنیم که آیا این شناسه از قبل موجود است یا خیر، اگر تهی باشد، این کار با شکست مواجه می‌شود و به‌طور خودکار ایجاد می‌شود

10
00:00:53,410 --> 00:00:55,870
آن را به خط بعدی که ما می خواهیم

11
00:00:56,080 --> 00:01:02,620
اما اگر یک شناسه داریم، ذخیره نباید شناسه جدید و محصول جدید ایجاد کند، در عوض باید به سادگی به روز شود

12
00:01:02,620 --> 00:01:07,980
موجود با این حال، ما هنوز باید همه محصولات را دریافت کنیم،

13
00:01:08,020 --> 00:01:14,950
بنابراین در واقع این باید به تماس ما منتقل شود زیرا ما به همه محصولات به هر حال و جدید نیاز داریم

14
00:01:15,070 --> 00:01:19,350
ایجاد ID نیز می تواند به آنجا منتقل شود اما بعد از این عبارت if.

15
00:01:19,360 --> 00:01:25,240
اکنون در این عبارت if، من اکنون می خواهم محصول موجود را به روز کنم و برای آن، ابتدا باید آن را پیدا کنم.

16
00:01:25,760 --> 00:01:34,450
بنابراین من دوباره با جستجو یا مرور همه محصولاتم با پیدا کردن، فهرست محصول موجود خود را پیدا خواهم کرد

17
00:01:34,780 --> 00:01:36,080
روش شاخص،

18
00:01:37,450 --> 00:01:43,900
همانطور که می دانیم محصولات یک آرایه خواهند بود و در آنجا به تمام محصولات ذخیره شده خود در موقت دسترسی خواهم داشت

19
00:01:43,900 --> 00:01:49,960
استدلال prod در اینجا یا در آرگومان prod این تابع ناشناس باید بگویم و به سادگی می توانم بررسی کنم

20
00:01:50,020 --> 00:01:56,640
اگر شناسه محصولی که در این آرایه به آن نگاه می کنم با این شناسه برابر است، به عبارت دیگر اگر من هستم

21
00:01:56,650 --> 00:01:58,250
اکنون به محصول نگاه می کنیم

22
00:01:58,390 --> 00:02:00,000
من برای ویرایش برنامه دارم

23
00:02:00,430 --> 00:02:05,920
اگر اینطور است پس من فهرست محصولی را که می‌خواهم ویرایش کنم پیدا کردم و اکنون به سادگی باید جایگزین کنم

24
00:02:05,920 --> 00:02:07,760
که در آن آرایه محصولات.

25
00:02:08,970 --> 00:02:09,750
بنابراین من یک را ایجاد خواهم کرد

26
00:02:09,780 --> 00:02:17,610
آرایه محصولات به روز شده که در آن من دوباره از آن عملگر spread برای بیرون کشیدن تمام عناصر محصول موجود استفاده می کنم.

27
00:02:17,760 --> 00:02:25,470
آنها را در یک آرایه جدید ذخیره کنید و سپس در آن آرایه محصولات به روز شده، فهرست محصول موجود خود را جایگزین می کنم

28
00:02:25,740 --> 00:02:28,150
با این چون این

29
00:02:28,230 --> 00:02:35,610
داخل این کلاس در اینجا البته محصول به روز شده است زیرا باید تصور کنید که من ایجاد می کنم

30
00:02:35,610 --> 00:02:43,770
یک نمونه محصول جدید، آن را با اطلاعات مربوط به محصول موجود خود پر می کنم و سپس فقط تماس می گیرم

31
00:02:43,770 --> 00:02:49,500
ذخیره کنید و متوجه می شوم که قبلاً این محصول را دارم و بنابراین فقط آن را در آرایه جایگزین می کنم

32
00:02:49,500 --> 00:02:54,490
که در فایل با محصول جدید ایجاد شده من در آن ذخیره می شود.

33
00:02:54,870 --> 00:02:59,550
بنابراین با ذخیره شدن آن، فقط باید آن اطلاعات را در فایل بنویسم،

34
00:02:59,760 --> 00:03:02,470
بنابراین فایل نوشتن fs همان چیزی است که باید اجرا کنم،

35
00:03:02,670 --> 00:03:04,800
بنابراین این کد ثابت می ماند،

36
00:03:04,950 --> 00:03:12,780
فقط باید آن را در محصولات به روز شده در اینجا صدا کنم و اکنون بخش دیگر را نیز در اینجا در اینجا قرار می دهم

37
00:03:12,780 --> 00:03:17,690
else بلاک کنید تا هر دو قطعه اجرا نشود، بلکه فقط یکی از آنها اجرا شود.

38
00:03:17,700 --> 00:03:23,150
بنابراین اکنون محصولات به روز شده را ذخیره می کنیم و فایل نوشتن همیشه جایگزین تمام محتوای قدیمی می شود.

39
00:03:23,190 --> 00:03:25,320
بنابراین ما آن را اضافه نمی کنیم یا چیزی شبیه به آن،

40
00:03:25,350 --> 00:03:26,500
جایگزین آن خواهد شد

41
00:03:26,910 --> 00:03:32,610
و بنابراین اکنون باید یک تابع ذخیره داشته باشیم که بتوانیم از آن برای افزودن محصولات جدید یا ویرایش استفاده کنیم

42
00:03:32,700 --> 00:03:34,680
محصولات موجود

43
00:03:34,680 --> 00:03:36,600
حالا این یک مفهوم مهم دارد،

44
00:03:36,600 --> 00:03:43,490
اکنون باید به کنترلر برویم و هنگام افزودن یک محصول جدید در اینجا در پست افزودن محصول، اکنون نیز

45
00:03:43,500 --> 00:03:50,850
باید null را به عنوان شناسه تنظیم کنیم، به عنوان اولین آرگومان در اینجا در سازنده محصول ما، زیرا ما به تازگی اضافه کردیم

46
00:03:50,850 --> 00:03:54,470
این به عنوان یک آرگومان اضافی در اینجا در سازنده

47
00:03:54,690 --> 00:04:01,020
و اگر null باشد، این بررسی ناموفق خواهد بود و بنابراین ما آن را به محصول جدید ایجاد شده تبدیل می کنیم

48
00:04:01,020 --> 00:04:02,510
حالتی که ما می خواهیم

49
00:04:03,840 --> 00:04:09,410
اکنون می‌توانیم روی روش افزودن پست، روش ویرایش محصول نیز کار کنیم

50
00:04:09,510 --> 00:04:11,090
من باید دو کار انجام دهم.

51
00:04:11,130 --> 00:04:17,280
اول از همه باید اطلاعات محصول را واکشی کنم، سپس باید یک نمونه محصول جدید ایجاد کنم

52
00:04:17,400 --> 00:04:22,220
و آن را با آن اطلاعات پر کنید و سپس باید save را صدا کنم.

53
00:04:22,290 --> 00:04:29,660
بیایید اول از همه شناسه محصول، شناسه محصول را با دسترسی به درخواست استخراج کنیم و آنجا که یک است

54
00:04:29,660 --> 00:04:30,660
ارسال درخواست،

55
00:04:30,750 --> 00:04:33,630
انتظار دارم این اطلاعات را در بدنه درخواست دریافت کنم.

56
00:04:33,900 --> 00:04:36,480
اما در حال حاضر این اتفاق نخواهد افتاد،

57
00:04:36,810 --> 00:04:40,590
پس بیایید ابتدا به نمای فایل ویرایش product.ejs برویم

58
00:04:40,920 --> 00:04:45,660
و در آنجا باید یک ورودی مخفی جدید اضافه کنم که شناسه محصول موجود را ذخیره می کند.

59
00:04:45,960 --> 00:04:51,240
با این حال، این فقط یک گزینه است اگر من در حال ویرایش یک محصول باشم، نه اگر محصولی را اضافه کنم،

60
00:04:51,240 --> 00:04:59,470
بنابراین اول از همه از ejs استفاده می کنم تا دوباره بررسی کنم که آیا در حال ویرایش هستم یا نه و همچنین آن را در اینجا ببندم، در اینجا ما نیز نیاز داریم

61
00:04:59,470 --> 00:05:02,540
بنابراین برای باز کردن یک بریس مجعد

62
00:05:02,760 --> 00:05:09,450
و اگر من در حال ویرایش و فقط در این مورد هستم، یک ورودی جدید در اینجا ارائه خواهم کرد که پنهان است، بنابراین

63
00:05:09,450 --> 00:05:15,770
کاربر نمی تواند ببیند که اکنون مقدار شناسه محصول من کجاست،

64
00:05:15,940 --> 00:05:21,660
بنابراین من از ejs برای خروجی شناسه محصول در آنجا استفاده می کنم. و این اکنون در فرم گنجانده خواهد شد

65
00:05:21,660 --> 00:05:25,070
اکنون فقط باید یک نام، شناسه محصول به آن بدهم

66
00:05:25,170 --> 00:05:33,770
و اکنون می توانم آن را با این نام در درخواست ورودی در کنترلر خود استخراج کنم، بنابراین محصول بدنه را درخواست کنید

67
00:05:33,800 --> 00:05:40,710
ID زیرا من از شناسه محصول به عنوان نام اینجا در نمای ورودی پنهان استفاده کردم.

68
00:05:40,730 --> 00:05:47,450
اکنون با واکشی آن شناسه، می‌توانم محصول خود را از طریق مدل محصول دریافت کنم، اما در واقع این همان است

69
00:05:47,450 --> 00:05:47,780
ویرایش کنید

70
00:05:47,790 --> 00:05:48,360
مسیر سمت راست،

71
00:05:48,410 --> 00:05:54,560
بنابراین مقادیر جدیدی را که می‌خواهم به عنوان بخشی از بدنه درخواست پست ذخیره کنم، دریافت می‌کنم زیرا کاربر آنها را وارد می‌کند

72
00:05:54,560 --> 00:05:55,550
اینجا در فرم

73
00:05:58,460 --> 00:05:59,010
اینجا

74
00:05:59,210 --> 00:06:08,060
همه اینها برای من ارسال می شود، بنابراین من اکنون به سادگی همه آن ها را در مقادیر یا ثابت هایی مانند به روز رسانی من ذخیره می کنم

75
00:06:08,240 --> 00:06:17,150
عنوان درخواست عنوان بدنه خواهد بود، من قیمت به روز شده خود را خواهم داشت که قیمت بدنه درخواستی است،

76
00:06:17,300 --> 00:06:20,120
من تصویر به روز شده ام را خواهم داشت

77
00:06:20,120 --> 00:06:25,360
url و شما می توانید این ثابت ها را هر طور که می خواهید نام گذاری کنید. البته اکنون مهم این است که به چه چیزی دسترسی دارید

78
00:06:25,360 --> 00:06:26,930
اینجا در بدن درخواست،

79
00:06:26,930 --> 00:06:34,680
این کلیدها باید با نام هایی که در ورودی های خود در نمای محصول به خوبی اضافه شده دارید مطابقت داشته باشند.

80
00:06:34,730 --> 00:06:41,390
آخرین اما نه کم اهمیت، ما توضیحات به روز شده را در اینجا دریافت کردیم که شرح بدن درخواست است. و اکنون با

81
00:06:41,390 --> 00:06:44,990
تمام این داده ها، من می توانم یک محصول به روز ایجاد کنم،

82
00:06:45,010 --> 00:06:51,760
این نام نیز به شما بستگی دارد، یک محصول جدید را معرفی کنید، بنابراین و در اینجا، من شناسه محصول موجود خود را به عنوان

83
00:06:51,760 --> 00:06:55,770
اولین استدلال و این تضمین می کند که در مدل محصول،

84
00:06:55,860 --> 00:07:01,720
در این بررسی اینجا یک شناسه معتبر پیدا می کنیم و بنابراین به جای این به این حالت به روز رسانی می رویم

85
00:07:02,420 --> 00:07:11,610
حالت اضافه کردن بنابراین من آن شناسه را پاس می کنم و عنوان به روز شده خود را پس از آن ارسال می کنم، سپس تصویر به روز شده خود را نیز ارسال می کنم

86
00:07:11,620 --> 00:07:12,440
آدرس اینترنتی،

87
00:07:12,550 --> 00:07:17,060
توضیحات به روز شده و قیمت به روز شده ام را ارسال می کنم.

88
00:07:17,320 --> 00:07:18,560
پس این چیزی است که من می گذرم

89
00:07:18,730 --> 00:07:26,970
و اکنون به لطف تغییراتی که در مدل محصول انجام دادیم، می توانم با محصول به روز شده تماس بگیرم، ذخیره کنم و امیدوارم این کار انجام شود

90
00:07:26,970 --> 00:07:30,880
فقط آن را ذخیره کنید و موجود را لغو کنید.

91
00:07:32,440 --> 00:07:33,740
حالا بیایید این را امتحان کنیم

92
00:07:33,790 --> 00:07:36,550
و برای آن، اجازه دهید به مسیرهای admin.js خود برویم

93
00:07:36,580 --> 00:07:44,290
اول از همه این اقدام محصول پست اضافه شده جدید را در مسیر پست محصول اضافه شده ثبت کنید

94
00:07:45,220 --> 00:07:50,810
و حالا بیایید صفحه خود را دوباره بارگذاری کنیم و چند علامت تعجب اضافه کنیم و محصول به روز رسانی را بزنید

95
00:07:51,220 --> 00:07:54,720
و مشکل این است که من هرگز پاسخی ارسال نمی کنم، بنابراین این کار انجام نشد

96
00:07:54,850 --> 00:08:01,660
اما اگر نگاهی به فایل products.json خود بیندازیم، محصول اول تغییر نکرده است، اما محصول دوم در واقع تغییر کرده است.

97
00:08:01,660 --> 00:08:03,490
همه علامت های تعجب را دارد،

98
00:08:03,490 --> 00:08:05,140
بنابراین این کار می کند.

99
00:08:05,230 --> 00:08:08,580
بنابراین چیزی که وجود ندارد این است که ما پاسخ را در کنترلر خود ارسال می کنیم،

100
00:08:08,800 --> 00:08:18,010
بنابراین در اینجا پس از فراخوانی save، در واقع res redirect را فراخوانی کرده و به just /admin برمی گردم

101
00:08:18,040 --> 00:08:21,690
یا بیایید نگاهی گذرا به مسیرهای admin.js بیندازیم،

102
00:08:21,770 --> 00:08:25,310
من می خواهم به /products بروم، بنابراین /admin/products

103
00:08:25,310 --> 00:08:27,670
منظورم این است که من می خواهم به آن تغییر مسیر دهم.

104
00:08:28,010 --> 00:08:29,330
پس بیایید این را ذخیره کنیم،

105
00:08:32,230 --> 00:08:33,160
به عقب برگرد و دوباره بارگیری کن،

106
00:08:33,160 --> 00:08:35,020
در اینجا ما علائم برآورد را نیز می بینیم،

107
00:08:35,020 --> 00:08:42,800
بیایید قیمت را به 30.95 تغییر دهیم و همچنین توضیحات را تغییر دهیم،

108
00:08:42,800 --> 00:08:43,940
واقعا عالی است

109
00:08:43,940 --> 00:08:49,400
محصول را به‌روزرسانی کنید، ما هدایت شده‌ایم و می‌توانیم تغییرات را در اینجا ببینیم و می‌توانیم دوباره آن را ویرایش کنیم

110
00:08:49,400 --> 00:08:49,820
البته،

111
00:08:49,820 --> 00:08:52,820
به عنوان مثال علائم برآورد را حذف کنید.

112
00:08:52,820 --> 00:08:53,840
بنابراین این کار می کند،

113
00:08:53,840 --> 00:08:56,000
اکنون می‌توانیم محصول را ویرایش کنیم.