1
00:00:02,300 --> 00:00:04,220
ما از قبل می‌توانیم روی سبد خرید کار کنیم،

2
00:00:04,250 --> 00:00:12,280
اکنون می خواهم موارد سبد خرید را در cart.ejs نمایش دهم. در آنجا من به سادگی یک بخش اصلی را قبل از پایان ejs اضافه می کنم

3
00:00:12,280 --> 00:00:12,900
عبارتند از،

4
00:00:12,910 --> 00:00:14,380
این مهم است و

5
00:00:14,380 --> 00:00:16,840
حالا اول از همه، اینجا چه کاری باید انجام دهیم؟

6
00:00:16,870 --> 00:00:22,570
ما باید بررسی کنیم که آیا محصولاتی داریم و آیا آنها را داریم، سپس می خواهیم آنها را نمایش دهیم و من این کار را انجام خواهم داد

7
00:00:22,570 --> 00:00:26,620
به سادگی آنها را در یک لیست واقعا خسته کننده نمایش دهید

8
00:00:26,620 --> 00:00:28,640
در حال حاضر، می توانیم بعداً استایل اضافه کنیم،

9
00:00:28,660 --> 00:00:31,630
فقط می خواهم ببینم کار می کند یا خیر.

10
00:00:31,630 --> 00:00:36,300
پس بیایید سریع به سمت کنترلر مغازه برویم، جایی که سبد خرید را بارگیری می کنیم و آنجا

11
00:00:36,310 --> 00:00:41,530
اول از همه باید آماده واکشی همه محصولات باشیم زیرا می خواهیم آنها را به سبد خرید بازگردانیم.

12
00:00:41,530 --> 00:00:46,510
البته نه همه محصولات ما، فقط محصولاتی که در سبد خرید داریم.

13
00:00:46,600 --> 00:00:51,510
بنابراین برای این کار ابتدا باید به مدل سبد خرید برویم و محصول را حذف کنیم و محصول را اضافه کنیم.

14
00:00:51,580 --> 00:00:59,970
اکنون ما به راهی نیاز داریم تا همه محصولات را در یک سبد خرید قرار دهیم. بنابراین من یک تابع استاتیک جدید اضافه می کنم، محصولات را از اینجا دریافت می کنم و

15
00:00:59,970 --> 00:01:05,220
در این تابع به فایل خود دسترسی پیدا می کنم و به سادگی شناسه های محصول را برمی گردم.

16
00:01:06,430 --> 00:01:13,170
من باید یک تماس پاسخ بگیرم، بنابراین می توانم با دریافت محصولات تماس بگیرم و سپس می توانم از این عملکرد استفاده کنم

17
00:01:13,240 --> 00:01:15,900
اینجا برای خواندن فایل

18
00:01:18,140 --> 00:01:23,440
و در اینجا می دانم که سبد خریدم را دریافت می کنم، این بار این کار را به درستی با محتوای فایل تجزیه json انجام می دهم،

19
00:01:23,500 --> 00:01:26,170
این الان سبد خرید است

20
00:01:26,270 --> 00:01:31,950
و در واقع من این سبد خرید را نام می‌گذارم و محصولات را دریافت نمی‌کنم زیرا کل سبد را در اینجا برمی‌گردانم

21
00:01:31,950 --> 00:01:33,370
در تماس من، این

22
00:01:33,380 --> 00:01:42,150
تمام کاری است که می خواهم انجام دهم اکنون بدیهی است که اگر هنوز چرخ دستی نداشته باشیم، ممکن است شکست بخورد، بنابراین من بررسی خواهم کرد که آیا خطا داریم

23
00:01:42,190 --> 00:01:51,450
و اگر اینطور باشد، من در اینجا callback null و در غیر این صورت در بلوک else در اینجا، این کار را خواهم کرد

24
00:01:51,450 --> 00:01:55,040
یک سبد خرید با مقادیر معتبر برگردانید.

25
00:01:56,060 --> 00:02:04,160
حالا می‌توانیم به کنترلر shop.js در get cart برویم و در اینجا به cart get cart می‌گویم. من باید بگذرم

26
00:02:04,160 --> 00:02:09,430
یک تابع وجود دارد، تابع تماس برگشتی که من به تازگی در مدل سبد خرید که در نهایت دریافت خواهم کرد، اضافه کردم

27
00:02:09,430 --> 00:02:13,770
سبد خرید و من دیدگاه خود را در داخل این تابع ارائه خواهم کرد.

28
00:02:13,910 --> 00:02:18,570
با این حال من فقط به سبد خرید نیاز ندارم، به اطلاعات کمی در مورد محصولات نیز نیاز دارم،

29
00:02:18,920 --> 00:02:25,620
بنابراین من از مدل محصول خود برای واکشی همه محصولات در اینجا استفاده خواهم کرد و پاسخ تماس خود را اینجا اضافه خواهم کرد

30
00:02:27,140 --> 00:02:33,770
و مطمئن شوید که این در تابع سبد خرید تو در تو است و ما در اینجا تماس های زیادی داریم اما

31
00:02:33,770 --> 00:02:34,730
هنوز قابل خواندن است،

32
00:02:34,730 --> 00:02:41,070
بعداً روش دیگری برای کار با بسیاری از اقدامات وابسته به همگام‌سازی پیدا خواهیم کرد.

33
00:02:41,120 --> 00:02:43,060
بنابراین اکنون سبد خریدم را دریافت کردم و محصولات را دریافت کردم،

34
00:02:43,060 --> 00:02:48,520
اکنون فقط باید محصولاتی را که در سبد خرید هستند فیلتر کنم. بنابراین من از همه چیز خواهم گذشت

35
00:02:48,520 --> 00:02:49,160
محصولات،

36
00:02:49,160 --> 00:02:55,390
بنابراین برای محصول محصولاتی که از طریق تمام محصولاتی که من در آنجا دارم حلقه می زنند و بررسی می کنم که آیا این وجود دارد یا خیر

37
00:02:55,400 --> 00:03:01,360
محصول داده شده نیز در یک سبد خرید ذخیره می شود و من می توانم این را بررسی کنم زیرا در سبد خرید من، شناسه محصول را دریافت کردیم،

38
00:03:01,490 --> 00:03:07,550
اگر نگاهی به cart.json در اینجا داشته باشید، شناسه محصول را ذخیره می کنیم.

39
00:03:07,720 --> 00:03:15,270
بنابراین، اگر این محصول را اینجا پیدا کنم، بررسی می کنم

40
00:03:15,270 --> 00:03:23,700
بنابراین اگر محصولی را که در سبد خرید مشاهده می‌کنم، اگر شناسه آن محصول برابر با شناسه محصول من در اینجا و

41
00:03:23,700 --> 00:03:29,520
البته این کدهایی است که اگر مقادیر زیادی داده را ذخیره کنید، می‌توان آن را بهبود بخشید، اما ما این کار را نمی‌کنیم

42
00:03:29,520 --> 00:03:34,000
به هر حال مقادیر زیادی داده را در فایل ما در اینجا ذخیره کنید،

43
00:03:34,080 --> 00:03:35,730
ما از یک پایگاه داده برای آن استفاده خواهیم کرد

44
00:03:35,880 --> 00:03:38,520
و بنابراین در حال حاضر این کاملا خوب است.

45
00:03:38,520 --> 00:03:46,310
و اگر شناسه‌ای را در سبد خرید پیدا کردم، خوب می‌دانم که محصول بخشی از آن است و بنابراین خواهم کرد

46
00:03:46,340 --> 00:03:53,080
یک ثابت جدید در اینجا ایجاد کنید، محصولات سبد خرید که یک آرایه است

47
00:03:53,280 --> 00:03:59,910
و من به سادگی آن محصول را به محصولات سبد خرید اضافه می کنم، بنابراین محصولات سبد خرید فشار می آورند و من محصول را اضافه می کنم

48
00:03:59,940 --> 00:04:03,060
من در حال حاضر در این تکرار از این حلقه نگاه می کنم.

49
00:04:03,210 --> 00:04:08,310
بنابراین این محصولی که من به آن نگاه می کنم، اگر بخشی از سبد خرید باشد، آن را به محصولات سبد خرید اضافه می کنم.

50
00:04:08,340 --> 00:04:13,500
این بدان معناست که پس از انجام حلقه، آرایه‌ای از محصولات سبد خرید خواهم داشت که شامل همه محصولات است

51
00:04:13,590 --> 00:04:15,600
که در واقع بخشی از سبد خرید هستند.

52
00:04:15,960 --> 00:04:20,130
در حال حاضر مهم است، فقط اضافه کردن محصول مانند این کافی نیست

53
00:04:20,160 --> 00:04:28,020
در عوض یک شی با یک فیلد داده محصول که محصول را در خود نگه می دارد و همچنین یک فیلد کمیت اضافه می کنم

54
00:04:28,020 --> 00:04:33,390
مقدار در یک سبد خرید نیز ذخیره می شود، اما در آن محصولی که من در حال بررسی آن هستم، نیست زیرا اینها فقط هستند

55
00:04:33,390 --> 00:04:34,910
محصولاتی که من در product.json ذخیره می کنم

56
00:04:34,920 --> 00:04:39,530
فایل، بدیهی است که هیچ مقداری در آن وجود ندارد. در سبد خرید

57
00:04:39,540 --> 00:04:45,390
با این حال، هر محصولی که من در آنجا ذخیره می کنم مقداری به آن متصل است.

58
00:04:45,390 --> 00:04:46,180
بنابراین در shop.js

59
00:04:46,260 --> 00:04:55,890
در اینجا، من همچنین مقدار محصول مورد نظر خود را ذخیره می کنم. اکنون در حال استخراج محصول سبد خریدم هستم

60
00:04:55,890 --> 00:04:56,580
اینجا،

61
00:04:56,820 --> 00:05:05,810
بنابراین در واقع من این هزینه، داده های محصول سبد خرید را ذخیره می کنم، محصول سبد خریدی را که پیدا می کنم در سبد خرید ذخیره می کنم

62
00:05:05,810 --> 00:05:11,870
آرایه محصولات در داده های محصول سبد خرید و من وجود آن را بررسی می کنم و اگر وجود داشته باشد می دانم

63
00:05:11,870 --> 00:05:17,330
اطلاعاتی درباره این محصول در سبد خرید وجود دارد، سپس اطلاعات کامل محصول اصلی را از آن ذخیره می کنم

64
00:05:17,330 --> 00:05:20,990
مدل محصول و از داده های محصول سبد خرید،

65
00:05:20,990 --> 00:05:28,360
من مقدار را می گیرم. بنابراین اکنون داده‌های کمیت و محصول را در آنجا دریافت کرده‌ایم و آن شی را به محصولات سبد خرید فشار می‌دهیم

66
00:05:28,810 --> 00:05:31,300
و محصولات سبد خرید همان چیزی است که می خواهم برگردانم،

67
00:05:31,510 --> 00:05:36,470
بنابراین در اینجا من یک فیلد محصولات را باز می گردانم که محصولات سبد خرید را در خود نگه می دارد،

68
00:05:36,610 --> 00:05:39,980
این به نظر من ارسال شده است.

69
00:05:40,210 --> 00:05:46,360
حال اگر هیچ محصولی در سبد خرید نداشته باشیم، محصولات سبد خرید به سادگی یک آرایه خالی خواهند بود و من می توانم بررسی کنم

70
00:05:46,360 --> 00:05:48,960
برای آن در قالب من.

71
00:05:48,980 --> 00:05:51,740
خب حالا بریم سراغ فایل cart.ejs

72
00:05:52,000 --> 00:06:00,580
و اول از همه من یک عبارت if را اضافه می کنم و بررسی می کنم که آیا محصول است و حالا به یاد داشته باشید، محصولات به سادگی این کلید در اینجا است

73
00:06:00,730 --> 00:06:02,970
من نظر خود را می فرستم،

74
00:06:03,730 --> 00:06:11,190
بنابراین بررسی می کنم که آیا طول محصولات بزرگتر از صفر است یا خیر و سپس آن را می بندم

75
00:06:11,210 --> 00:06:16,960
و همچنین قبلاً یک بلوک دیگری را در اینجا تعریف می‌کنم، زیرا می‌خواهم در صورتی که هیچ محصولی وارد نشد، چیزی را رندر کنم

76
00:06:16,960 --> 00:06:18,270
یک گاری هم

77
00:06:18,540 --> 00:06:23,910
بنابراین اینجا در بلوک else و پس از آن باید آن بریس فرفری را ببندید، در بلوک else من رندر خواهم کرد

78
00:06:23,930 --> 00:06:27,600
تگ h1 که در آن می گویم هیچ محصولی در سبد خرید وجود ندارد،

79
00:06:30,340 --> 00:06:31,130
مثل این

80
00:06:31,300 --> 00:06:36,930
اما در اینجا البته من می خواهم محصولات را در اولین بلوک دستور if ارائه کنم.

81
00:06:36,970 --> 00:06:42,970
بنابراین در اینجا من لیست نامرتب را فعلاً ارائه می کنم که در آن به سادگی تمام محصولات را با استفاده از ejs حلقه می زنم.

82
00:06:45,710 --> 00:06:50,130
محصولات برای هر محصول

83
00:06:53,470 --> 00:07:07,590
و این یک تابع ناشناس در اینجا مانند آن است، سپس حلقه forEach را در اینجا با بستن حلقه ببندید

84
00:07:07,590 --> 00:07:13,650
براکت آن تابع ناشناس و سپس براکت این متد forEach در اینجا.

85
00:07:13,890 --> 00:07:16,280
اکنون در اینجا می خواهم اطلاعات محصول را خروجی بگیرم

86
00:07:16,410 --> 00:07:20,430
و اکنون مهم است که آن محصول را در اینجا در نظر داشته باشید،

87
00:07:20,520 --> 00:07:26,300
شاید ما باید نام آن را داده های محصول، که این است

88
00:07:29,880 --> 00:07:36,960
در واقع محصولی با فیلد داده محصول و فیلد کمیت دارد یا در واقع به آن اشاره دارد

89
00:07:37,170 --> 00:07:40,500
و فیلد داده محصول محصولی است که به آن علاقه دارم

90
00:07:40,590 --> 00:07:42,330
اما من به مقدار آن نیز نیاز دارم.

91
00:07:42,330 --> 00:07:48,300
بنابراین شاید حتی من آن داده‌های محصول را نام نمی‌برم، فقط p

92
00:07:48,450 --> 00:07:56,160
و سپس در اینجا، من می توانم داده های p.product را با اشاره به داده های محصول تودرتو که وجود دارد، خروجی کنم

93
00:07:56,160 --> 00:07:58,140
اطلاعات محصول مانند عنوان،

94
00:07:58,380 --> 00:08:04,570
بنابراین .product data.title به من اجازه می دهد عنوان را خروجی کنم. و سپس همچنین شاید در پرانتز و این است

95
00:08:04,590 --> 00:08:07,580
بدون نحو ejs، این متن کدگذاری شده عادی در اینجا است

96
00:08:07,680 --> 00:08:15,540
اما در آنجا من دوباره از ejs برای دسترسی به p.quantity استفاده می کنم و به یاد می آورم که p آن شی است

97
00:08:15,600 --> 00:08:20,700
ما آرایه محصولات سبد خرید را در کد باطن خود ارسال کردیم.

98
00:08:21,270 --> 00:08:22,890
خب حالا بیایید ببینیم که آیا این کار می کند،

99
00:08:22,920 --> 00:08:30,450
اگر این را ذخیره کنم و این صفحه سبد خرید را دوباره بارگیری کنم، هیچ محصولی در سبد خرید نمی بینیم. اگر من به محصولات اینجا و

100
00:08:30,490 --> 00:08:34,750
من روی افزودن به سبد خرید کلیک می کنم، ما واقعاً آن را در صفحه خود می بینیم.

101
00:08:34,830 --> 00:08:38,850
اگر این را یک بار دیگر اضافه کنم، دوبار آن را می بینیم.

102
00:08:38,880 --> 00:08:40,420
بنابراین این اکنون کار می کند،

103
00:08:40,530 --> 00:08:43,020
آخرین مرحله این است که می خواهم بتوانم آن را حذف کنم.